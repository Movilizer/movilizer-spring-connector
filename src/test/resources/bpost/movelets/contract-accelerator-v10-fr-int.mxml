<?xml version="1.0"?>
<MovilizerMovelet xmlns="http://movilitas.com/movilizer/v14" moveletKey="be.bpost.contract-accelerator-v10-fr-int" moveletKeyExtension="" namespace="HSFL#FR" privateNamespace="true" icon="25" moveletType="MULTI" metaMoveletType="NONE" initialQuestionKey="26" transactional="false" validTillDate="2015-12-31T23:00:00.000Z" encryptionAlgorithm="" priority="0" moveletDownloadPriority="0" replyUploadPriority="0" syncPriority="NONE" visible="true" filterValue="" moveletVersion="0">
  <question key="17" title="Timestamps Distribution" type="41" backNavigationAllowed="true" sortAnswersByClientKey="false" portalMayDelete="true" portalMayEdit="true" portalMayMove="true">
    <answer key="#17_1" nextQuestionKey="END" position="0" action="FULLSYNCSILENT" triggerScreenValueChangedEvent="false" dummyAnswer="false" portalMayDelete="true" portalMayEdit="true" portalMayMove="true">
      <text>Start_distri</text>
    </answer>
    <answer key="#17_2" nextQuestionKey="END" position="1" action="FULLSYNCSILENT" triggerScreenValueChangedEvent="false" dummyAnswer="false" portalMayDelete="true" portalMayEdit="true" portalMayMove="true">
      <text>User_ID</text>
    </answer>
    <answer key="#17_3" nextQuestionKey="END" position="2" action="FULLSYNCSILENT" triggerScreenValueChangedEvent="false" dummyAnswer="false" portalMayDelete="true" portalMayEdit="true" portalMayMove="true">
      <text>End_Distri</text>
    </answer>
    <answer key="#17_4" nextQuestionKey="END" position="3" action="NONE" triggerScreenValueChangedEvent="false" dummyAnswer="false" portalMayDelete="true" portalMayEdit="true" portalMayMove="true">
      <text>barcode</text>
    </answer>
    <onEnterAssignment>propFile = concat($local:path_files, $local:properties_filename);

                        $local:gf_userid = readProperty(propFile, "userID");
                        $local:gf_loginTS = readProperty(propFile, "timestamp");
                            $local:gf_taskId = readProperty(propFile, "taskId");

                        tmpLang = readProperty(propFile, "language");
                        if (tmpLang != null ?AND length(tmpLang) ?gt 0) {
                            $local:lang = tmpLang;
                        }

                        writeProperty(propFile, "userID", "");
                        writeProperty(propFile, "timestamp", "");
                        writeProperty(propFile, "language", "");
                                                writeProperty(propFile, "taskId", "");</onEnterAssignment>
    <onLeaveOkPrepareAssignment/>
    <onLeaveOkPersistAssignment>setAnswerValue($answer:"#17_1", $local:lf_start_datetime );
setAnswerValue($answer:"#17_2", $local:gf_userid);
setAnswerValue($answer:"#17_3", $local:lf_end_datetime );
setAnswerValue($answer:"#17_4", $local:gf_taskId );

client = getClientType();

if (client == 10 || client == 11) {
$local:conId = connect("gps://", null);
                        }</onLeaveOkPersistAssignment>
    <onLeaveBackAssignment/>
  </question>
  <question key="18" title="Encodez la date du pick up" type="8" backNavigationAllowed="true" sortAnswersByClientKey="false" portalMayDelete="true" portalMayEdit="true" portalMayMove="true">
    <answer attributeType="72" key="#18_1" nextQuestionKey="36" position="0" action="NONE" triggerScreenValueChangedEvent="false" dummyAnswer="false" portalMayDelete="true" portalMayEdit="true" portalMayMove="true">
      <text>Ok</text>
    </answer>
    <text>Encodez la date du pick up</text>
    <onEnterAssignment/>
    <onLeaveOkPrepareAssignment/>
    <onLeaveOkPersistAssignment/>
    <onLeaveBackAssignment/>
    <onScreenValueChangeEvent/>
    <onExternalEvent/>
  </question>
  <question key="26" title="Statut distribution" type="6" backNavigationAllowed="true" sortAnswersByClientKey="false" portalMayDelete="true" portalMayEdit="true" portalMayMove="true">
    <answer key="#26_1" clientKey="Pas de pick up à faire" nextQuestionKey="37" position="0" action="NONE" triggerScreenValueChangedEvent="false" dummyAnswer="false" portalMayDelete="true" portalMayEdit="true" portalMayMove="true">
      <text>Pas de pick up à faire</text>
    </answer>
    <answer key="#26_2" clientKey="Contrat déjà renvoyé" nextQuestionKey="37" position="1" action="NONE" triggerScreenValueChangedEvent="false" dummyAnswer="false" portalMayDelete="true" portalMayEdit="true" portalMayMove="true">
      <text>Contrat déjà renvoyé</text>
    </answer>
    <answer key="#26_3" clientKey="Mis dans la boîte" nextQuestionKey="37" position="2" action="NONE" triggerScreenValueChangedEvent="false" dummyAnswer="false" portalMayDelete="true" portalMayEdit="true" portalMayMove="true">
      <text>Mis dans la boîte</text>
    </answer>
    <answer key="#26_4" clientKey="Pick up prévu" nextQuestionKey="18" position="3" action="NONE" triggerScreenValueChangedEvent="false" dummyAnswer="false" portalMayDelete="true" portalMayEdit="true" portalMayMove="true">
      <text>Pick up prévu</text>
    </answer>
    <text>Choisissez le statut de distribution</text>
    <onEnterAssignment>$local:lf_start_timestamp = systemTime();
$local:lf_start_datetime = timestampToDatetime($local:lf_start_timestamp, "GMT+2", false);</onEnterAssignment>
    <onLeaveOkPrepareAssignment/>
    <onLeaveOkPersistAssignment/>
    <onLeaveBackAssignment/>
    <onExternalEvent/>
  </question>
  <question key="36" title="Numéro de téléphone" type="5" backNavigationAllowed="true" sortAnswersByClientKey="false" portalMayDelete="true" portalMayEdit="true" portalMayMove="true">
    <answer attributeType="0" key="#36_1" nextQuestionKey="37" position="0" action="NONE" triggerScreenValueChangedEvent="true" dummyAnswer="false" portalMayDelete="true" portalMayEdit="true" portalMayMove="true">
      <text>Numéro de téléphone</text>
      <predefinedValue/>
    </answer>
    <text>Encodez le numéro de téléphone du client</text>
  </question>
  <question key="37" title="Commentaire distri [facultatif]" type="5" backNavigationAllowed="true" sortAnswersByClientKey="false" portalMayDelete="true" portalMayEdit="true" portalMayMove="true">
    <answer attributeType="0" key="#37_1" nextQuestionKey="17" position="0" action="NONE" triggerScreenValueChangedEvent="true" dummyAnswer="false" portalMayDelete="true" portalMayEdit="true" portalMayMove="true">
      <text>Commentaire</text>
      <predefinedValue/>
    </answer>
    <text>Notez ici un éventuel commentaire lié à la distribution</text>
    <onEnterAssignment/>
    <onLeaveOkPrepareAssignment/>
    <onLeaveOkPersistAssignment>$local:lf_end_timestamp = systemTime();
$local:lf_end_datetime = timestampToDatetime($local:lf_end_timestamp, "GMT+2", false);</onLeaveOkPersistAssignment>
    <onLeaveBackAssignment/>
    <onScreenValueChangeEvent/>
    <onExternalEvent/>
  </question>
  <syncDeleteAssignment>descrFile =  concat($local:path_files, $local:descriptor_filename); conID = connect(concat("file:///", descrFile), "delete"); if (isConnectionOpen(conID)) {
    close(conID);
}</syncDeleteAssignment>
  <syncDownloadAssignment>$local:path_files =  "Program Files/Movilizer/";
$local:properties_filename = "cdm.properties";
$local:descriptor_filename = "ContractAcceleratorIntegratedFR.descriptor";
$local:icon_filename = "auto.png";

setCustomizingProperty($customizing:"screen.mainmenu.title.text","bpost apps");

$local:replaceSyncIcons = function(masterDataPool, customizingDescriptor, masterDataKey)
                {
                    image = getMasterData(masterDataPool, masterDataKey);
                    setCustomizingProperty(customizingDescriptor, image["data"]);
                };

call($local:replaceSyncIcons)($masterdata:"DOCU", $customizing:"icon.mainmenu.background", "menu_bg");
call($local:replaceSyncIcons)($masterdata:"DOCU", $customizing:"icon.category.background", "menu_bg");
call($local:replaceSyncIcons)($masterdata:"DOCU", $customizing:"icon.splash", "splash");
call($local:replaceSyncIcons)($masterdata:"DOCU", $customizing:"icon.screenmenu", "minicon");

setCustomizingProperty( $customizing:"screen.header.color.start", "#E4273B");
setCustomizingProperty( $customizing:"screen.header.color.end", "#B51A28");
setCustomizingProperty( $customizing:"screen.header.color.orientation", 2);

setCustomizingProperty( $customizing:"screen.footer.color.start", "#E4273B");
setCustomizingProperty( $customizing:"screen.footer.color.end", "#B51A28");
setCustomizingProperty( $customizing:"screen.footer.color.orientation", 2);

setCustomizingProperty( $customizing:"screen.body.color.start", "#FFFFFF");
setCustomizingProperty( $customizing:"screen.body.color.end", "#FFFFFF");
setCustomizingProperty( $customizing:"screen.body.color.orientation", 2);

setCustomizingProperty($customizing:"screen.searchbar.color.start","#E87984");
setCustomizingProperty($customizing:"screen.searchbar.color.end","#BF6972");
setCustomizingProperty($customizing:"screen.searchbar.color.orientation",2);

descrFile =  concat($local:path_files, $local:descriptor_filename); writeProperty(descrFile, "AppName", "Contract Accelerator Integrated");
 writeProperty(descrFile, "startupParameter", concat("-executeforce ", $movelet));
writeProperty(descrFile, "icon", $local:icon_filename);
writeProperty(descrFile, "showInMainMenu", "0");

conID = -1;
conID = connect(concat("file:///", $local:path_files, $local:icon_filename ), "file"); if (isConnectionOpen(conID)) {
  icon = $base64:&lt; iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAADS0lEQVR42u2ZXYiMYRTHd2eF8bE2yy5jt1XLSqtt7FqtQSxJSpriwse68JGvskjbXshHLoiifCRLqJ0L5MJX7MUqjXC3SYpSshdYF/IRJax9/Y/+Tz1N7xjv7Du7O3X+9buYaZ5znnPe55znvE1OjkqlUqlUKpVKpVKpVCqVSqVSqVQqlUqlUqlUqjRUCy6lwR6Ql+3BrwXfQTd47YFvwAFtoCAbA5cnd4xB/AArPK6fCjq5/gWYkk3Bjwb3rOCXpWlnPOignY9gcTYEXwVe+RC80QiWgcMy2jWQg5dj/tXH4I0GgfO0K1wAgwdK0GGwD9wEPdYmP4MnPtNt2X8Eivsz8Drw0NpQf/AGXAet4Cw4CprBBrCEjTMj12hzwtMYyEhJ3gGb2U96ra1ZErgbX8BJUJhu8CNZ206W8wBMSCcB81MYfgy2g9lgBlgNroBffRBUF28KOaGrQCOIgU9Jfr8OFHlNQPQfdSY1VgbK2XwqeUPUgOXgZYYC7+F7Q4S+EpGHdttl3U7uL+AlAdNdDMl9v57O6sEJNh3J/hqWTQEHpM4MJKDFCraBN8ItcBxUg3wwDtxIWNfANfle5/uuBEPnaEiO+weXDcoUN5TrlybMCr3lOd80xf9pF9tSehvpezh4b02Uc7lulNcy2JLgoJ4zwVv5LhgMOpFIxAmFQvZGTnFtLnjqYwL2Moht5jsX/xLsTPo/wO86rFMzzGsCJIirNPSMRhqN81gs5sTjcae9vd0Jh8N2j6hgvZ3xMQGL6L8thX9pxGPAHH7ez3XVXnuAkSw6Au7S0GExLJkX54ampiZ7s9KMSsBBHxNgnmJHCv/3GWwlp1dTNhW9GYgkCZNpaJM4kmMnmTcbiEaj9gBSy64rSZjHhHhlITGfTQKupfB/mb+TWypkrSv0YzIcy0T8vebk2EnmxXkgEDAbaLWc5vFmqEpybaXDAtMAXfz/Biv5u3LuuYx7zvXz/WAaeJdk6qrjBsIJJyjPJ0S7Gazt+ycbn0lUaabfEOVKOcQ7VxrlDk6EZgMlGfY/C1zk4NPCwa3GanjBvnhNDiY53pP8PnJJVOziu9qvevcyMBWx1krTGTZ8eAjysjORTW+I/jOhUqlUKpVK9R/6AwjNj0PwrpakAAAAAElFTkSuQmCC>;
  writeBinary(conID, icon);
  close(conID);
}
$local:startWedge = function()
                    {
                        // To be sure that the DataWedge is started
                        client = getClientType();
                        if (client == 20 || client == 21)
                        {
                            startDataWedge = "exec:///Program Files/Movilizer/StartDataWedge.exe";
                            conDWID = -1;
                            conDWID = connect(startDataWedge, null);

                            if (isConnectionOpen(conDWID))
                            {
                                sleep(1000);
                                close(conDWID);
                            }
                        }
                    };

                    $local:stopWedge = function()
                    {
                        //To be sure that the DataWedge is stopped

                        client = getClientType();
                        if (client == 20 || client == 21)
                        {
                            stopDataWedge = "exec:///Program Files/Movilizer/StopDataWedge.exe";
                            conDWID = -1;
                            conDWID = connect(stopDataWedge, null);
                            if (isConnectionOpen(conDWID))
                            {
                                sleep(1000);
                                close(conDWID);
                            }
                        }
                    };
</syncDownloadAssignment>
  <moveletStartAssignment>$local:getMarterdataLanguageDependant = function(language, key)
                    {
                        temp = null;
                        if(language=='FR' || language=='fr')
                        {
                            temp = getMasterdata($masterdata:"FR",key);
                        }
                        else
                        {
                            if(language=='NL' || language=='nl')
                            {
                                temp = getMasterdata($masterdata:"NL",key);
                            }
                            else
                            {
                                temp = getMasterdata($masterdata:"FR",key);
                            }
                        }
                        return temp;
                    };</moveletStartAssignment>
  <name>Contract Accelerator Full V10 FR Integrated</name>
</MovilizerMovelet>